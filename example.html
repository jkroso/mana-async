<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>mana-result example</title>
    <style media="screen">
      body {
        margin: 0;
        font-family: sans-serif;
        font-size: 60pt;
        position: absolute;
        left: calc(50% - 30pt);
        top: calc(50% - 30pt);
      }
      .loading {
        opacity: 0.2;
      }
      .error {
        color: red;
      }
    </style>
    <script type="text/javascript">
      import {pending} from 'result'
      import {App,JSX} from 'mana'
      import State from './index'

      var count = 0

      const app = new App(Promise.resolve(count), cursor => {
        const pending = state => <div class="loading">{state.previousNode || 'pending'}</div>
        const done = value => <span class="done">{value}</span>
        const fail = value => <span class="error">{value}</span>
        return <State promise={cursor.value} pending done fail/>
      })

      window.onload = () => {
        app.mountIn(document.body)
        setInterval(() => {
          app.cursor.value = pending()
          setTimeout(() => {
            if (Math.random() < 0.5)
            app.cursor.value.error(++count)
            else
            app.cursor.value.write(++count)
          }, 1e3)
        }, 3e3)
      }
    </script>
  </head>
</html>
